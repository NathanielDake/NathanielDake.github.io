<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.6" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">
<link rel="stylesheet" type="text/css" href="../css/readable.css">
<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Nathaniel Dake Blog</title>

<style type = "text/css">
body {
  font-family: "sans-serif";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Nathaniel Dake Blog</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../Deep_Learning.html">Deep Learning</a>
</li>
        
<li>
  <a href="../Machine_Learning.html">Machine Learning</a>
</li>
        
<li>
  <a href="../Mathematics.html">Mathematics</a>
</li>
        
<li>
  <a href="../AI.html">AI</a>
</li>
        
<li>
  <a href="../NLP.html">NLP</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="https://github.com/NathanielDake/nathanieldake.github.io"> source </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-E-commerce-Project">4. E-commerce Project<a class="anchor-link" href="#4.-E-commerce-Project">&#182;</a></h1><p>We are now going to look at training <strong>logistic regression</strong> with softmax. In my other walk throughs on logistic regression, we weren't looking at multiclass classification (just binary) so we had just been using the <strong>sigmoid</strong> function, and not softmax. This will give us the chance to see how logistic regression performs compared to a neural network. Remember, for logistic regression our architecture looks like:</p>
<p><img src="https://drive.google.com/uc?id=1Pc0zQLlr3nRfTlrECn6a8ypXbbLVysl3" width="550"></p>
<p>The only difference now is that instead of using the sigmoid at at the logistic neuron, we are going to use the softmax as we are performing multiclass classification.</p>
<p><img src="https://drive.google.com/uc?id=1JE-6sRZ7wOJgTL4ltD4WY61kVv2HdbM8" width="400"></p>
<p>We can start with our imports.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="k">import</span> <span class="n">shuffle</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And lets define our <code>get_data</code> function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_data</span><span class="p">():</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ecommerce_data.csv&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="c1"># one-hot encode the categorical data</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="o">+</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">X2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:(</span><span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:(</span><span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># non-categorical</span>

    <span class="c1"># one-hot</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
      <span class="n">t</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
      <span class="n">X2</span><span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="o">+</span><span class="n">D</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X2</span>

    <span class="c1"># split train and test</span>
    <span class="n">Xtrain</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span>
    <span class="n">Ytrain</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span>
    <span class="n">Xtest</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>
    <span class="n">Ytest</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:]</span>

    <span class="c1"># normalize columns 1 and 2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Xtrain</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Xtrain</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">Xtrain</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Xtrain</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>
        <span class="n">Xtest</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Xtest</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>

    <span class="k">return</span> <span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytest</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are going to need a function to get the indicator matrix from the targets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y2indicator</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> 
    <span class="k">return</span> <span class="n">ind</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can can get our data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytest</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">Ytest</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And convert our <code>Y</code> data into an indicator matrix.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ytrain_ind</span> <span class="o">=</span> <span class="n">y2indicator</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="n">Ytest_ind</span> <span class="o">=</span> <span class="n">y2indicator</span><span class="p">(</span><span class="n">Ytest</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is shape (400 x 4) because we have have four classes that make up Y.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ytrain_ind</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(400, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now randomly initialize our weights.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can define our <code>softmax</code> function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">expA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expA</span> <span class="o">/</span> <span class="n">expA</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now lets define our forward function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, our predict function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">P_Y_given_X</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">P_Y_given_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our classification rate:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">classification_rate</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y</span> <span class="o">==</span> <span class="n">P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And the <strong>Cross Entropy</strong>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cross_entropy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">pY</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pY</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have done all of that, we can enter our train loop. Note: our weight update rule in gradient descent is based on the rule we derived last lecture: <code>Z.T.dot(T - Y)</code>. Only in the case of logistic regression, we only have and input and output layer, no hidden layer, so in this case <code>Z</code> is going to be <code>X</code>. We are also now going to be performing gradient descent, not ascent, so we have a minus in our update, and we are subtracting the targets from the predictions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_costs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_costs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">pYtrain</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>        <span class="c1"># find the predicitons for y train</span>
    <span class="n">pYtest</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>        <span class="c1"># find the predicitons for y test</span>
    
    <span class="n">ctrain</span> <span class="o">=</span> <span class="n">cross_entropy</span><span class="p">(</span><span class="n">Ytrain_ind</span><span class="p">,</span> <span class="n">pYtrain</span><span class="p">)</span>     <span class="c1"># Ytrain_ind === targets in this case</span>
    <span class="n">ctest</span> <span class="o">=</span> <span class="n">cross_entropy</span><span class="p">(</span><span class="n">Ytest_ind</span><span class="p">,</span> <span class="n">pYtest</span><span class="p">)</span>
    <span class="n">train_costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrain</span><span class="p">)</span>
    <span class="n">test_costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctest</span><span class="p">)</span>
    
    <span class="c1"># now we can perform gradient descent</span>
    <span class="n">W</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pYtrain</span> <span class="o">-</span> <span class="n">Ytrain_ind</span><span class="p">)</span>  
    <span class="n">b</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">pYtrain</span> <span class="o">-</span> <span class="n">Ytrain_ind</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">ctrain</span><span class="p">,</span> <span class="n">ctest</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final training classification rate: &quot;</span><span class="p">,</span> <span class="n">classification_rate</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">pYtrain</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final testing classification rate: &quot;</span><span class="p">,</span> <span class="n">classification_rate</span><span class="p">(</span><span class="n">Ytest</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">pYtest</span><span class="p">)))</span>

<span class="n">legend1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train cost&#39;</span><span class="p">)</span>
<span class="n">legend2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test cost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">legend1</span><span class="p">,</span> <span class="n">legend2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0 0.5487036337934679 0.587425339056817
1000 0.08847309034724614 0.09187567492094431
2000 0.08377182711917026 0.09052982548097642
3000 0.08196144166596504 0.09077510228825146
4000 0.08102329620858013 0.09127851663313276
5000 0.0804589669016488 0.0918014318036505
6000 0.08008728169999321 0.09228846524706961
7000 0.07982711471431775 0.09272871265757494
8000 0.0796368998911137 0.09312353966499383
9000 0.0794932153858824 0.09347752945439439
(&#39;Final training classification rate: &#39;, 0.93)
(&#39;Final testing classification rate: &#39;, 0.89)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXcAAAD8CAYAAACMwORRAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4wLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvFvnyVgAAIABJREFUeJzt3X2UFPWd7/H3t3t6ZnhUkEHFgUA8EEUYRhxYDBFdIT7EKyLrvavLruG66ubueq4J9xgxuceY3GOWNZ7Euwk3CXfj1Xgwmhg1rCESk2CQbIygQQgqCgg4aHQY5EEe5qH7e//o6pmenunpZqaHnur5vM5puupXv6r6VVfz6ZpfVVebuyMiIqUlUuwGiIhI4SncRURKkMJdRKQEKdxFREqQwl1EpAQp3EVESpDCXUSkBCncRURKkMJdRKQElRVrxaNGjfLx48cXa/UiIqH08ssv73P3qlz1ihbu48ePZ+PGjcVavYhIKJnZ7nzq5dUtY2ZXmNk2M9tuZkuz1PkvZvaamW01s0dPpLEiIlJYOY/czSwKLAc+DdQDG8xslbu/llZnInAXMNvdPzSz0X3VYBERyS2fI/eZwHZ33+nuzcBjwDUZdW4Blrv7hwDu/kFhmykiIicinz73s4B30sbrgb/IqDMJwMx+B0SBe9z92cwFmdmtwK0A48aN60l7RQaklpYW6uvrOX78eLGbIidJZWUl1dXVxGKxHs1fqBOqZcBE4BKgGlhnZlPd/UB6JXdfAawAqKur043kRfJUX1/PsGHDGD9+PGZW7OZIH3N3Ghsbqa+vZ8KECT1aRj7dMnuBsWnj1UFZunpglbu3uPvbwJskw15ECuD48eOcdtppCvYBwsw47bTTevWXWj7hvgGYaGYTzKwcuB5YlVHnaZJH7ZjZKJLdNDt73CoR6UTBPrD0dn/nDHd3bwVuA9YArwM/dvetZvY1M5sfVFsDNJrZa8Ba4A53b+xVy7LZ/Xv4zb3Q2twnixcRKQV5Xefu7qvdfZK7n+3u9wZld7v7qmDY3X2Ju09296nu/liftbj+JVh3HyRa+mwVItLZ0KFDO5V973vf44c//GGPlrdp0yYuvPBCzjvvPGpqanj88cfbpl1yySV84hOfoKamhnPOOYfbbruNAwfaT+EdO3aMiy++mHg8zq5du3j00Z59teaTn/xkj+brja9//ettw83NzcyZM4fW1taCrye895bRD3uLFN3nPvc5brzxxh7NO3jwYH74wx+ydetWnn32WT7/+c93CPCVK1eyefNmNm/eTEVFBddc034F9oMPPsjChQuJRqPdhnuu0PyP//iPHrW9N9LDvby8nLlz53b4YCuUEIa7+h1F+ot77rmH+++/H0gebd95553MnDmTSZMm8cILLwAQj8e54447mDFjBjU1NXz/+98HYNKkSUycmLzuYsyYMYwePZqGhoZO6ygvL+e+++5jz549vPrqq0Ay+FNhv3TpUl544QVqa2v51re+xUMPPcT8+fO59NJLmTt3Lh999BFz585l+vTpTJ06lZ/97Gdty079NfL8889zySWXcN1113HOOeewaNEivIsDyO3btzNv3jymTZvG9OnT2bFjB+7OHXfcwZQpU5g6dWpbUL/33nvMmTOH2tpapkyZwgsvvMDSpUs5duwYtbW1LFq0CIAFCxawcuXK3u+MDEW7t0zv6chdBqav/vtWXnv3UEGXOXnMcL5y9Xm9Xk5raysvvfQSq1ev5qtf/Sq/+tWv+MEPfsApp5zChg0baGpqYvbs2Vx22WUdLvF76aWXaG5u5uyzz+5yudFolGnTpvHGG29w7rnnsnPnTlI3Hly2bBn3338/zzzzDAAPPfQQr7zyCps3b2bkyJG0trby1FNPMXz4cPbt28esWbOYP39+pxOWf/zjH9m6dStjxoxh9uzZ/O53v+NTn/pUhzqLFi1i6dKlXHvttRw/fpxEIsGTTz7Jpk2bePXVV9m3bx8zZsxgzpw5PProo1x++eV8+ctfJh6Pc/ToUS666CK+853vsGnTprZlTpkyhQ0bNvT6tc8UvnDXFQMi/dbChQsBuOCCC9i1axcAv/zlL9m8eTNPPPEEAAcPHuStt95qC/f33nuPv/u7v+Phhx8mEsnemZA6kt63bx+nnnpqt+349Kc/zciRI9vm+9KXvsS6deuIRCLs3buX999/nzPOOKPDPDNnzqS6uhqA2tpadu3a1SHcDx8+zN69e7n22muB5JeMANavX88NN9xANBrl9NNP5+KLL2bDhg3MmDGDm266iZaWFhYsWEBtbW2XbY1Go5SXl3P48GGGDRvW7XadiPCFe4r63GWAKsQRdl+pqKgAkoGV6u92d7797W9z+eWXd6p/6NAhrrrqKu69915m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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><br></br></p>
<h1 id="Ecommerce-Project---Training-a-Neural-Network">Ecommerce Project - Training a Neural Network<a class="anchor-link" href="#Ecommerce-Project---Training-a-Neural-Network">&#182;</a></h1><p>Let's now look at how a neural network performs compared to logistic regression in this case. Again, lets start with our imports:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="k">import</span> <span class="n">shuffle</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And again, we will want to define our y indicator function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">y2indicator</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">K</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span> 
    <span class="k">return</span> <span class="n">ind</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And get our data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">Ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">Ytest</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now lets set the size of our <strong>hidden layer</strong>, and the size of our input layer:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">)</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">Ytest</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And lets convert our Target labels into an indicator matrix:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ytrain_ind</span> <span class="o">=</span> <span class="n">y2indicator</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="n">Ytest_ind</span> <span class="o">=</span> <span class="n">y2indicator</span><span class="p">(</span><span class="n">Ytest</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now randomly initialize our weights:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, define our softmax:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">expA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expA</span> <span class="o">/</span> <span class="n">expA</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now for the forward function. It is similar to the forward function from Logistic Regression, but notice that now have an additional layer to consider. Remember, Z is the output of hidden layer nodes, and we need to return Z because it is used in the derivative.</p>
<p>Keep in mind, as we run through this prediction, when we first perform matrix multiplication between our input matrix $X$ and our first weight matrix $W_1$, each weight matrix is having the dot product performed against it. As we know, the more similar two vectors are, the greater their dot product.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">):</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b1</span><span class="p">)</span>        
    <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b2</span><span class="p">),</span> <span class="n">Z</span>   
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now lets redefine <code>predict</code> and <code>classification_rate</code>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">P_Y_given_X</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">P_Y_given_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">classification_rate</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y</span> <span class="o">==</span> <span class="n">P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And lets redefine cross entropy as well:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cross_entropy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">pY</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pY</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now enter our main training loop:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_costs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_costs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">pYtrain</span><span class="p">,</span> <span class="n">Ztrain</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
    <span class="n">pYtest</span><span class="p">,</span> <span class="n">Ztest</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">Xtest</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
    
    <span class="n">ctrain</span> <span class="o">=</span> <span class="n">cross_entropy</span><span class="p">(</span><span class="n">Ytrain_ind</span><span class="p">,</span> <span class="n">pYtrain</span><span class="p">)</span>
    <span class="n">ctest</span> <span class="o">=</span> <span class="n">cross_entropy</span><span class="p">(</span><span class="n">Ytest_ind</span><span class="p">,</span> <span class="n">pYtest</span><span class="p">)</span>
    <span class="n">train_costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctrain</span><span class="p">)</span>
    <span class="n">test_costs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ctest</span><span class="p">)</span>
    
    <span class="c1"># we can now start gradient descent</span>
    <span class="n">W2</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">Ztrain</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">pYtrain</span> <span class="o">-</span> <span class="n">Ytrain_ind</span><span class="p">)</span>
    <span class="n">b2</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">pYtrain</span> <span class="o">-</span> <span class="n">Ytrain_ind</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># need to get error at the hidden node</span>
    <span class="c1"># note, (1 - Ztrain * Ztrain) is the derivative of tanh, if we had been using sigmoid</span>
    <span class="c1"># we would have it be (1 - Ztrain) * Ztrain</span>
    <span class="n">dZ</span> <span class="o">=</span> <span class="p">(</span><span class="n">pYtrain</span> <span class="o">-</span> <span class="n">Ytrain_ind</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Ztrain</span> <span class="o">*</span> <span class="n">Ztrain</span><span class="p">)</span> 
    <span class="c1"># now we can update W1 and W2</span>
    <span class="n">W1</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">Xtrain</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dZ</span><span class="p">)</span>
    <span class="n">b1</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">dZ</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">ctrain</span><span class="p">,</span> <span class="n">ctest</span>
        
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final training classification rate: &quot;</span><span class="p">,</span> <span class="n">classification_rate</span><span class="p">(</span><span class="n">Ytrain</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">pYtrain</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final testing classification rate: &quot;</span><span class="p">,</span> <span class="n">classification_rate</span><span class="p">(</span><span class="n">Ytest</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">pYtest</span><span class="p">)))</span>

<span class="n">legend1</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train cost&#39;</span><span class="p">)</span>
<span class="n">legend2</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_costs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test cost&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">legend1</span><span class="p">,</span> <span class="n">legend2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0 0.5112511245754163 0.5034374398825299
1000 0.040578783494983936 0.045707901918409934
2000 0.029555888166024804 0.04633345269429838
3000 0.0235877160252051 0.04479735810092709
4000 0.020515948962842093 0.04573993366731693
5000 0.018515357771577968 0.047367539403102205
6000 0.017084671294244937 0.04888953258949811
7000 0.016012764493820292 0.05013368928403129
8000 0.015181263275568237 0.05110831091060879
9000 0.014516974759324945 0.05185692286936616
(&#39;Final training classification rate: &#39;, 0.9775)
(&#39;Final testing classification rate: &#39;, 0.93)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<hr>
&copy; 2018 Nathaniel Dake

</div>
</div>
</body>
</html>
